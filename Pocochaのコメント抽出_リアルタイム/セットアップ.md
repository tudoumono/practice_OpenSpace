# Pocochaコメント抽出ツール - セットアップガイド（手動ログイン版）

## 📋 事前準備

### 1. 必要なファイルの準備

以下のファイルを同じフォルダに配置してください：
- `pococha_extractor.py` - メインのスクリプト
- `requirements.txt` - 必要なパッケージリスト
- `.gitignore` - Git除外設定

**注意**: 手動ログイン方式に変更されたため、`.env`ファイルは不要になりました。

### 2. Python環境のセットアップ

```bash
# 仮想環境の作成（推奨）
python -m venv pococha_env

# 仮想環境のアクティベート
# Windows:
pococha_env\Scripts\activate
# Mac/Linux:
source pococha_env/bin/activate

# 必要なパッケージのインストール
pip install -r requirements.txt
```

## 🚀 使用方法

### 基本的な使用方法

```bash
# 10分間コメントを抽出
python pococha_extractor.py "https://pococha.com/app/lives/ライブID"

# 30分間抽出
python pococha_extractor.py -t 30 "https://pococha.com/app/lives/ライブID"

# デバッグモードで実行（推奨）
python pococha_extractor.py --debug "https://pococha.com/app/lives/ライブID"

# ヘッドレスモードで実行
python pococha_extractor.py --headless "https://pococha.com/app/lives/ライブID"

# カスタム出力ファイル名
python pococha_extractor.py -o "my_comments.csv" "https://pococha.com/app/lives/ライブID"
```

## 🔐 手動ログイン方式

### ログインフロー
1. **スクリプト実行**: ツールを起動
2. **ブラウザ自動起動**: Chromeブラウザが自動で開く
3. **手動ログイン**: お好みの方法でPocochaにログイン
   - Google認証
   - LINE認証
   - Apple ID
   - メールアドレス/パスワード
4. **2段階認証**: 必要に応じて認証コードを入力
5. **確認**: ログイン完了後、ターミナルでEnterキーを押す
6. **自動処理開始**: 以降は自動でコメント抽出

### ログイン時の注意事項
- ブラウザは自動で開きますが、ログインは手動で行ってください
- 2段階認証が設定されている場合は、認証コードを手動で入力
- ログイン完了後、必ずターミナルに戻ってEnterキーを押してください

## 🎮 自動処理される内容

ログイン後、以下が自動で処理されます：
1. **ライブページアクセス**: 指定されたライブストリームURL
2. **ダイアログ処理**: 「Web版Pocochaへようこそ」等の確認ダイアログ
3. **再生開始**: ライブストリームの再生ボタンクリック
4. **コメント抽出**: リアルタイムでコメントを監視・保存

## 📊 出力されるデータ

CSVファイルには以下の情報が含まれます：
- **タイムスタンプ**: コメント取得時刻
- **ユーザー名**: コメント投稿者名
- **レベル**: ユーザーレベル
- **コメント**: コメント内容
- **コメントタイプ**: user（一般ユーザー）/ system（運営）

## ⚠️ 注意事項とベストプラクティス

### 利用規約の遵守
- Pocochaの利用規約を必ず確認
- 過度なアクセスは避ける
- 個人利用の範囲で使用

### セキュリティ
- 手動ログインにより認証情報の保存が不要
- ブラウザのセッションは自動で管理
- 不要になったらブラウザセッションを削除

### パフォーマンス
- 長時間の実行は避ける（推奨：最大60分）
- ネットワーク状況を考慮して実行間隔を調整
- 複数のライブを同時に監視しない

## 🔧 トラブルシューティング

### よくある問題と解決方法

#### 1. ログインがうまくいかない
```
解決方法:
- ブラウザで手動ログインを確実に完了
- 2段階認証がある場合は必ず認証コードを入力
- ログイン完了後、必ずターミナルでEnterキーを押す
```

#### 2. ダイアログが閉じられない
```
解決方法:
- デバッグモードで実行してスクリーンショットを確認
- 手動でダイアログのOKボタンをクリック
- ページの読み込み完了を待つ
```

#### 3. 再生ボタンが押せない
```
解決方法:
- 手動で再生ボタンをクリック
- ライブが実際に配信中か確認
- ページのリロードを試す
```

#### 4. コメントが取得できない
```
解決方法:
- ライブが実際に配信中か確認
- 再生が正常に開始されているか確認
- HTMLの構造が変更されている可能性
```

#### 5. ChromeDriverエラー
```
解決方法:
- Chromeブラウザを最新版に更新
- webdriver-managerが自動でドライバを更新
- 手動でChromeDriverを削除して再実行
```

## 🎯 実行例

```bash
# 基本的な実行
python pococha_extractor.py "https://www.pococha.com/ja-jp/app/lives/67761158"

# 実行の流れ:
# 1. ツール起動
# 2. Chromeブラウザ自動起動
# 3. 手動でPocochaにログイン
# 4. ターミナルでEnterキーを押す
# 5. 自動でライブページにアクセス
# 6. ダイアログを自動処理
# 7. 再生ボタンを自動クリック
# 8. コメント抽出開始
```


**⚠️ 免責事項**: このツールの使用は自己責任でお願いします。利用規約違反や法的問題については責任を負いかねます。

**🔄 変更点**: 
- 自動ログイン機能を削除し、手動ログイン方式に変更
- セキュリティ向上のため認証情報の保存が不要
- より安全で利用規約に配慮した設計